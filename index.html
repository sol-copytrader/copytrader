<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>SOL CopyTrader — Mirror elite wallets on Solana</title>
  <meta name="description" content="Copytrade SOL-based tokens with priority fees, private routing, and MEV/rug protection. Non-custodial, simple pricing: 1% per successful trade." />
  <meta property="og:title" content="SOL CopyTrader" />
  <meta property="og:description" content="Copytrade SOL-based tokens with priority fees, private routing, and MEV/rug protection." />
  <meta property="og:type" content="website" />
  <meta name="theme-color" content="#9945FF" />
  <link rel="icon" href="./favicon.ico" sizes="any">

  <style>
    :root{
      --bg: #0b0d12;
      --panel: #0f131b;
      --muted: #9aa4b2;
      --text: #e6edf5;

      /* Solana palette */
      --primary: #9945FF;  /* purple */
      --accent:  #14F195;  /* green */
      --ring: rgba(153,69,255,.35);

      --shadow: 0 10px 25px rgba(0,0,0,.35);
      --radius: 14px;

      /* Background flair using Solana gradient colors */
      --grad:
        radial-gradient(1200px 600px at 10% -10%, rgba(153,69,255,.25), transparent 60%),
        radial-gradient(1000px 500px at 110% 10%, rgba(20,241,149,.18), transparent 60%);
    }

    @media (prefers-color-scheme: light) {
      :root{
        --bg: #f7f9fc;
        --panel: #ffffff;
        --muted: #5b6876;
        --text: #0b1220;
        --ring: rgba(153,69,255,.25);
        --shadow: 0 10px 25px rgba(0,0,0,.08);
        --grad:
          radial-gradient(1200px 600px at 10% -10%, rgba(153,69,255,.20), transparent 60%),
          radial-gradient(1000px 500px at 110% 10%, rgba(20,241,149,.12), transparent 60%);
      }
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, Helvetica, Arial, Apple Color Emoji, Segoe UI Emoji;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      letter-spacing: .01em;
      background-image: var(--grad);
      background-repeat: no-repeat;
      background-attachment: fixed;
      overflow-x: hidden; /* avoid horizontal scroll with overlap */
    }

    /* Layout */
    .container { width: min(1120px, 92vw); margin: 0 auto; }
    header {
      position: sticky; top: 0; z-index: 50;
      backdrop-filter: saturate(1.2) blur(10px);
      background: color-mix(in oklab, var(--bg) 65%, transparent);
      border-bottom: 1px solid color-mix(in oklab, var(--panel) 70%, transparent);
    }
    .nav { display: flex; align-items: center; justify-content: space-between; padding: 14px 0; gap: 16px; }
    .brand { display: flex; align-items: center; gap: 12px; text-decoration: none; color: inherit; }
    .logo {
      width: 34px; height: 34px; border-radius: 10px;
      background: conic-gradient(from 200deg, var(--primary), var(--accent), var(--primary));
      box-shadow: inset 0 0 10px rgba(255,255,255,.25), var(--shadow);
    }
    .brand span { font-weight: 700; letter-spacing: .02em; font-size: 1.05rem; }
    .nav a { color: var(--muted); text-decoration: none; padding: 8px 10px; border-radius: 8px; }
    .nav a:hover { color: var(--text); background: color-mix(in oklab, var(--panel) 85%, transparent); }

    /* Buttons */
    .btn {
      appearance: none; border: 0; cursor: pointer;
      padding: 12px 16px; border-radius: 12px; font-weight: 600;
      color: #0b1220;
      background: linear-gradient(90deg, var(--primary), var(--accent));
      box-shadow:
        0 8px 20px rgba(153,69,255,.35),
        inset 0 -2px 0 rgba(0,0,0,.15);
      transition: transform .05s ease, filter .15s ease, box-shadow .15s ease;
    }
    .btn:hover { filter: brightness(1.05); }
    .btn:active { transform: translateY(1px); }
    .btn.secondary {
      background: color-mix(in oklab, var(--panel) 90%, transparent);
      color: var(--text);
      box-shadow: var(--shadow);
    }
    .btn.ghost {
      background: transparent; color: var(--text);
      border: 1px solid color-mix(in oklab, var(--muted) 30%, transparent);
    }
    .btn.small { padding: 10px 12px; font-weight: 600; border-radius: 10px; }

    /* Hero */
    .hero { padding: 72px 0 36px; }
    /* Nudge the whole hero a bit left to create breathing room on the right (desktop only) */
    @media (min-width: 921px){
      .hero .container { transform: translateX(-14px); }
    }
    .hero-grid {
      display: grid;
      grid-template-columns: 1.05fr .9fr .6fr; /* add third column for the screenshot */
      gap: 28px; align-items: center;
    }
    .badge {
      display:inline-flex; align-items:center; gap:8px;
      border: 1px solid color-mix(in oklab, var(--primary) 45%, transparent);
      color: var(--text);
      padding: 6px 10px; border-radius: 999px;
      background:
        linear-gradient(90deg, color-mix(in oklab, var(--primary) 22%, transparent), color-mix(in oklab, var(--accent) 18%, transparent));
      font-weight: 600; font-size: .9rem;
    }
    h1 { margin: 14px 0 10px; font-size: clamp(2rem, 4.5vw, 3.25rem); line-height: 1.1; letter-spacing: .005em; }
    .lead { color: var(--muted); font-size: clamp(1rem, 2.6vw, 1.18rem); margin: 12px 0 26px; }
    .cta { display:flex; gap:12px; flex-wrap: wrap; align-items: center; }
    .hero-card {
      position: relative;
      z-index: 2; /* sit above the screenshot so it 'peeks' from behind */
      background:
        linear-gradient(180deg, color-mix(in oklab, var(--panel) 90%, transparent), transparent 120%),
        color-mix(in oklab, var(--panel) 80%, transparent);
      border: 1px solid color-mix(in oklab, var(--muted) 18%, transparent);
      border-radius: var(--radius); padding: 18px; box-shadow: var(--shadow);
    }
    .stat { display:flex; align-items:center; justify-content: space-between; padding: 12px 14px; border-radius: 12px;
            background: color-mix(in oklab, var(--panel) 88%, transparent); margin-top: 10px; }
    .pill { font-variant-numeric: tabular-nums; font-weight: 700; }

    /* Add perspective to the column so 3D transforms look natural */
    .screenshot-col{
      align-self: center;
      perspective: 1200px;
      perspective-origin: 60% 40%;
    }

    /* Tilt the whole framed image (border + glow + picture) to the LEFT */
    .screenshot-wrap{
      position: relative;
      margin-left: -90px;           /* keeps the peek under the snapshot card */
      padding: 10px;                /* visible border */
      border-radius: 20px;
      background: #14F195;          /* border color */
      box-shadow:
        0 0 0 2px #14F195,
        0 0 36px rgba(20,241,149,.45);  /* outside glow */
      z-index: 1;
      width: clamp(220px, 26vw, 360px);

      /* 3D left tilt */
      transform-style: preserve-3d;
      transform: translateY(10px) rotateY(-14deg) rotateX(2deg);
    }

    /* inward (into-the-image) glow stays the same */
    .screenshot-wrap::before{
      content:"";
      position:absolute;
      inset: 10px;
      border-radius: 14px;
      box-shadow: inset 0 0 42px rgba(20,241,149,.35);
      pointer-events:none;
    }

    /* The image itself no longer needs its own skew/tilt */
    .screenshot{
      display:block;
      width: 100%;
      height: auto;
      border-radius: 14px;
      transform: none; /* <-- remove any previous skew/tilt here */
      filter: drop-shadow(0 12px 24px rgba(0,0,0,.35));
    }

    /* Responsive: flatten on small screens for readability */
    @media (max-width: 920px){
      .screenshot-col{ perspective: none; }
      .screenshot-wrap{ transform: none; margin: 0 auto; width: min(420px, 86vw); }
    }


    /* Sections */
    section { padding: 52px 0; }
    .grid-3 { display:grid; grid-template-columns: repeat(3, 1fr); gap: 18px; }
    .card {
      background: #121722; /* fallback */
      background: color-mix(in oklab, var(--panel) 80%, transparent);
      border: 1px solid color-mix(in oklab, var(--muted) 18%, transparent);
      border-radius: var(--radius); padding: 18px; box-shadow: var(--shadow);
    }
    .card h3 { margin: 6px 0 6px; font-size: 1.05rem; }
    .muted { color: var(--muted); }
    .kicker { color: var(--muted); font-weight: 700; letter-spacing: .08em; text-transform: uppercase; font-size: .78rem; }
    .list { margin: 10px 0 0; padding-left: 18px; }
    .list li { margin: 6px 0; }

    /* Footer */
    footer { padding: 36px 0 64px; color: var(--muted); }
    .footer-grid { display:grid; grid-template-columns: 1fr auto; gap: 18px; align-items:center; }
    .links { display:flex; gap: 14px; flex-wrap: wrap; justify-content: flex-end; }
    .links a { color: var(--muted); text-decoration: none; }
    .links a:hover { color: var(--text); }

    /* Responsive */
    @media (max-width: 1100px){
      .screenshot-wrap{ margin-left: -50px; width: clamp(200px, 30vw, 320px); }
    }
    @media (max-width: 920px) {
      .hero-grid { grid-template-columns: 1fr; gap: 18px; }
      header .nav { padding: 10px 0; }
      .grid-3 { grid-template-columns: 1fr; }
      .screenshot-col{
        order: 3;
        justify-self: center;
        width: 100%;
      }
      .screenshot-wrap{
        margin: 0 auto;
        transform: none; /* simplify on small screens */
        width: min(420px, 86vw);
      }
      .screenshot{
        transform: none; /* remove tilt on mobile for readability */
      }
    }

    /* Focus ring */
    :focus-visible { outline: 2px solid var(--ring); outline-offset: 2px; border-radius: 10px; }

    /* Small helper for address display */
    .addr { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; }
    .notice { font-size: .92rem; padding: 10px 12px; border-radius: 12px; border: 1px dashed color-mix(in oklab, var(--muted) 30%, transparent); }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 18px;
    }
    .stat-tile {
      background: #121722; /* fallback */
      background: color-mix(in oklab, var(--panel) 80%, transparent);
      border: 1px solid color-mix(in oklab, var(--muted) 18%, transparent);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
    }
    .stat-label { color: var(--muted); font-weight: 600; letter-spacing: .02em; }
    .stat-value {
      font-size: clamp(1.6rem, 4vw, 2.2rem);
      font-weight: 800; line-height: 1.2; margin-top: 6px;
      font-variant-numeric: tabular-nums;
      background-image: linear-gradient(90deg, var(--primary), var(--accent));
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }
    .stat-sub { margin-top: 6px; }
    @media (max-width: 920px) {
      .stats-grid { grid-template-columns: 1fr; }
    }

    /* ===== Hero spacing & width (desktop) ===== */
    @media (min-width: 921px){
      .hero { padding: 96px 0 56px; } /* more vertical breathing room */

      /* make the hero wider than the rest of the site */
      .hero .container {
        width: min(1320px, 96vw);   /* wider than the default 1120px */
        transform: translateX(-24px); /* nudge left a touch more */
      }

      .hero-grid {
        column-gap: 44px;  /* more space between columns */
        row-gap: 28px;
        grid-template-columns: 1.1fr 0.95fr 0.7fr; /* relax column proportions */
      }

      .hero-card { padding: 22px; }        /* more air inside the snapshot card */
      .stat { padding: 14px 16px; margin-top: 14px; }
    }

    /* element-to-element spacing inside the hero */
    .hero h1   { margin: 18px 0 16px; }
    .hero .lead { margin: 14px 0 28px; }
    .hero .cta  { gap: 16px; margin-top: 6px; }
    .hero .notice { margin-top: 20px !important; }

    /* ===== Mobile/tablet tidy ===== */
    @media (max-width: 920px){
      .hero { padding: 64px 0 40px; }
      .hero .container { transform: none; } /* keep centered on small screens */
      .hero-grid { row-gap: 18px; }         /* comfortable vertical spacing */
    }

    /* ===== Hero: equal columns, no overlap ===== */
    @media (min-width: 921px){
      /* keep the hero a bit wider if you like */
      .hero .container {
        width: min(1320px, 96vw);
        transform: translateX(-16px);
      }

      .hero-grid{
        /* three equal columns with consistent gaps */
        grid-template-columns: repeat(3, minmax(0, 1fr));
        column-gap: 40px;
        row-gap: 32px;
        align-items: start; /* keep tops aligned */
      }

      /* no layering tricks needed anymore */
      .hero-card{ z-index: auto; }

      /* 3D tilt context */
      .screenshot-col{
        align-self: start;
        perspective: 1200px;
        perspective-origin: 60% 40%;
      }

      /* remove the previous overlap & keep the left tilt */
      .screenshot-wrap{
        margin-left: 0 !important;   /* kill old negative margin */
        z-index: auto !important;    /* no stacking above/below */
        width: clamp(280px, 30vw, 440px);
        transform-style: preserve-3d;
        transform: translateY(10px) rotateY(-14deg) rotateX(2deg);
      }
    }

    /* keep mobile tidy — stack as before */
    @media (max-width: 920px){
      .hero-grid { grid-template-columns: 1fr; row-gap: 18px; }
      .screenshot-col{ perspective: none; }
      .screenshot-wrap{ transform: none; margin: 0 auto; width: min(420px, 86vw); }
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header>
    <div class="container nav" role="navigation" aria-label="Main">
      <a class="brand" href="#top">
        <img class="logo" src="./logo.png" width="34" height="34" alt="SOL CopyTrader logo">
        <span>SOL CopyTrader</span>
      </a>
      <nav class="hide-on-mobile" aria-label="Primary">
        <a href="#stats">Stats</a>
        <a href="#benefits">Benefits</a>
        <a href="#how">How it works</a>
        <a href="#pricing">Pricing</a>
        <a href="#faq">FAQ</a>
      </nav>
      <button id="connectBtn" class="btn small" aria-live="polite">Connect Wallet</button>
    </div>
  </header>

  <!-- Hero -->
  <main id="top" class="hero">
    <div class="container hero-grid">
      <div>
        <span class="badge" aria-label="Non-custodial and fast">⚡ Non-custodial • <span aria-hidden="true">Sub-second routing</span></span>
        <h1>Copy elite Solana wallets.<br />Your keys, your pace.</h1>
        <p class="lead">
          Mirror trades from any public SOL wallet with your own slippage, priority fee, and tip.
          Our private routing aims to land fast and reduce MEV & rug risks — all while you stay in control.
        </p>
        <div class="cta">
          <button id="heroConnect" class="btn">Link your wallet</button>
          <a class="btn ghost" href="#benefits">See how it works</a>
          <span id="walletState" class="muted" aria-live="polite" aria-atomic="true"></span>
        </div>
        <div class="notice" style="margin-top:14px;">
          Recommended starting balance: <strong>≥ 0.5 SOL</strong> to cover fees and volatility. You can start with less; we’ll simply warn you.
        </div>
      </div>

      <div class="hero-card" aria-label="Live service snapshot">
        <div class="kicker">Service snapshot</div>
        <div class="stat"><span>Current network</span><span id="networkLabel" class="pill">mainnet-beta</span></div>
        <div class="stat"><span>Execution route</span><span class="pill">Private relay preferred</span></div>
        <div class="stat"><span>Platform fee</span><span class="pill">1% per successful trade</span></div>
        <div class="stat"><span>Custody</span><span class="pill">Non-custodial</span></div>
      </div>

      <!-- Screenshot column (peeks from behind the snapshot card) -->
      <div class="screenshot-col" aria-hidden="true">
        <div class="screenshot-wrap">
          <img class="screenshot" src="phantom.png" alt="Phantom wallet screenshot showing a trade" />
        </div>
      </div>
    </div>
  </main>

  <!-- Stats -->
  <section id="stats" aria-labelledby="stats-heading">
    <div class="container">
      <div class="kicker">Live snapshot</div>
      <h2 id="stats-heading" style="margin:6px 0 14px;">Performance at a glance</h2>

      <div class="stats-grid">
        <div class="stat-tile">
          <div class="stat-label">Volume traded</div>
          <div class="stat-value">$<span class="count" data-format="usd" data-target="12400000">0</span></div>
          <div class="stat-sub muted">USD (lifetime)</div>
        </div>

        <div class="stat-tile">
          <div class="stat-label">Users</div>
          <div class="stat-value"><span class="count" data-target="8214">0</span></div>
          <div class="stat-sub muted">Active accounts</div>
        </div>

        <div class="stat-tile">
          <div class="stat-label">Total trades</div>
          <div class="stat-value"><span class="count" data-target="147892">0</span></div>
          <div class="stat-sub muted">Executed on Solana</div>
        </div>
      </div>
    </div>
  </section>

  <!-- Benefits -->
  <section id="benefits">
    <div class="container">
      <div class="kicker">Why this bot</div>
      <h2 style="margin:6px 0 14px;">Fast, flexible, and protective by design</h2>
      <div class="grid-3">
        <div class="card">
          <h3>Copy any wallet</h3>
          <p class="muted">Follow known whales or your own curated list. You choose the wallets, we mirror their on-chain intent.</p>
          <ul class="list muted">
            <li>Set per-leader copy %</li>
            <li>Allowlist tokens & DEXes</li>
            <li>Pause/resume anytime</li>
          </ul>
        </div>
        <div class="card">
          <h3>MEV & rug defenses</h3>
          <p class="muted">Private submissions & heuristics help reduce sandwiching and detect sketchy token settings.</p>
          <ul class="list muted">
            <li>Slippage & priority caps</li>
            <li>Sell-protect triggers</li>
            <li>Token safety checks</li>
          </ul>
        </div>
        <div class="card">
          <h3>Zero upfront cost</h3>
          <p class="muted">Only pay <strong>1%</strong> on successful trades. No monthly fees, no lock-ups, no hidden spreads.</p>
          <ul class="list muted">
            <li>Clear receipts per trade</li>
            <li>Non-custodial control</li>
            <li>Instant opt-out</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- How it works -->
  <section id="how">
    <div class="container">
      <div class="kicker">How it works</div>
      <h2 style="margin:6px 0 14px;">Three steps to mirror trades</h2>
      <div class="grid-3">
        <div class="card">
          <h3>1) Link your wallet</h3>
          <p class="muted">Connect Phantom, Solflare, or Backpack. You approve transactions — we never take custody.</p>
        </div>
        <div class="card">
          <h3>2) Choose leaders</h3>
          <p class="muted">Add public wallet addresses to follow. Set copy size, slippage, priority fee, and tip.</p>
        </div>
        <div class="card">
          <h3>3) We mirror & report</h3>
          <p class="muted">We recreate routes and submit privately for fast inclusion. You get clear PnL & trade logs.</p>
        </div>
      </div>
      <div style="margin-top:18px;" class="notice">
        <strong>Heads-up:</strong> Fast inclusion is targeted, not guaranteed. Market conditions and validator schedules can affect timing.
      </div>
    </div>
  </section>

  <!-- Pricing -->
  <section id="pricing">
    <div class="container">
      <div class="kicker">Pricing</div>
      <h2 style="margin:6px 0 14px;">Simple & transparent</h2>
      <div class="card" style="display:flex; gap:18px; align-items:center; justify-content: space-between; flex-wrap: wrap;">
        <div>
          <h3 style="margin:0;">1% per successful trade</h3>
          <p class="muted" style="margin:6px 0 0;">That’s it. No setup fees, subscriptions, or hidden spreads.</p>
        </div>
        <button class="btn" id="pricingConnect">Connect & Get Started</button>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq">
    <div class="container">
      <div class="kicker">FAQ</div>
      <h2 style="margin:6px 0 14px;">Answers at a glance</h2>
      <div class="grid-3">
        <div class="card">
          <h3>Is this non-custodial?</h3>
          <p class="muted">Yes. You connect a wallet and authorize transactions. You can disconnect any time.</p>
        </div>
        <div class="card">
          <h3>Minimum to start?</h3>
          <p class="muted">No enforced minimum. We recommend ≥ 0.5 SOL to comfortably cover fees and volatility.</p>
        </div>
        <div class="card">
          <h3>Guaranteed profits?</h3>
          <p class="muted">No. Crypto markets are risky. Use sensible slippage/priority caps and never over-allocate.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <div class="container footer-grid">
      <div style="display:flex; align-items:center; gap:10px;">
        <span class="logo" aria-hidden="true"></span>
        <div>
          <strong>SOL CopyTrader</strong><br />
          <small>© <span id="year"></span> All rights reserved.</small>
        </div>
      </div>
  
      <!-- Keep only these four links -->
      <div class="links">
        <a id="linkDocs" href="#" aria-label="Documentation">Docs</a>
        <a id="linkTwitter" href="#" aria-label="Twitter / X">X / Twitter</a>
        <a id="linkTerms" href="#" aria-label="Terms of Service">Terms</a>
        <a id="linkPrivacy" href="#" aria-label="Privacy Policy">Privacy</a>
      </div>
    </div>
  </footer>  

  <!-- Wallet modal -->
  <dialog id="walletModal" style="border:none; border-radius: 16px; padding:0; max-width: 520px; width: calc(92vw); box-shadow: var(--shadow);">
    <div class="card" style="border-radius: 16px;">
      <div style="display:flex; align-items:center; justify-content: space-between;">
        <h3 style="margin:0;">Connect a wallet</h3>
        <button id="closeModal" class="btn secondary small" aria-label="Close wallet options">Close</button>
      </div>
      <p class="muted" style="margin:10px 0 14px;">Choose a wallet to connect. If you don’t have one installed, use an install link below.</p>
      <div style="display:grid; gap:10px;">
        <button class="btn" id="connectPhantom">Connect Phantom</button>
        <button class="btn" id="connectSolflare">Connect Solflare</button>
        <button class="btn" id="connectBackpack">Connect Backpack</button>
      </div>
      <div class="muted" style="margin-top:12px; font-size:.92rem;">
        Don’t have a wallet? <a href="https://phantom.app/" target="_blank" rel="noopener">Phantom</a> •
        <a href="https://solflare.com/" target="_blank" rel="noopener">Solflare</a> •
        <a href="https://www.backpack.app/" target="_blank" rel="noopener">Backpack</a>
      </div>
    </div>
  </dialog>

  <script>
    // --- Small helpers ---
    const $ = (sel) => document.querySelector(sel);
    const byId = (id) => document.getElementById(id);
    const year = new Date().getFullYear();
    byId('year').textContent = year.toString();

    // Prefer mainnet label
    byId('networkLabel').textContent = 'mainnet-beta';

    // --- Wallet detection ---
    const providers = {
      phantom: () => window?.phantom?.solana || (window?.solana?.isPhantom ? window.solana : null),
      solflare: () => window?.solflare,
      backpack: () => window?.backpack?.solana || (window?.solana?.isBackpack ? window.solana : null)
    };

    function shorten(addr) {
      return addr.length > 10 ? addr.slice(0,4) + '…' + addr.slice(-4) : addr;
    }

    async function connectWith(providerName){
      try {
        let provider = providers[providerName] && providers[providerName]();
        if (!provider) {
          openModal(); // guide to install
          return;
        }
        const resp = await provider.connect({ onlyIfTrusted: false });
        const pubkey = resp?.publicKey?.toString?.() || provider.publicKey?.toString?.();
        if (pubkey) {
          setConnected(pubkey, providerName);
          closeModal();
          attachAccountListener(provider, providerName);
        }
      } catch (e) {
        console.warn('Connect error:', e);
        alert('Connection was cancelled or failed. Try again.');
      }
    }

    function setConnected(pubkey, providerName) {
      const connectedTxt = `Linked ✓ • ${providerName} • <span class="addr">${shorten(pubkey)}</span>`;
      $('#walletState').innerHTML = connectedTxt;
      const btns = [byId('connectBtn'), byId('heroConnect'), byId('pricingConnect')].filter(Boolean);
      btns.forEach(b => {
        b.textContent = 'Wallet Linked';
        b.classList.add('secondary');
        b.disabled = true;
        b.setAttribute('aria-label', `Wallet connected: ${pubkey}`);
      });
      // Persist basic state in session for the upcoming app UI
      sessionStorage.setItem('linkedWallet', JSON.stringify({ pubkey, providerName, ts: Date.now() }));
    }

    function attachAccountListener(provider, label='wallet'){
      provider?.on?.('accountChanged', (pk)=>{
        if (!pk) {
          sessionStorage.removeItem('linkedWallet');
          location.reload();
        } else {
          setConnected(pk.toString(), label);
        }
      });
      provider?.on?.('disconnect', ()=>{
        sessionStorage.removeItem('linkedWallet');
        location.reload();
      });
    }

    // Load state if already connected in this tab
    (function restore(){
      const raw = sessionStorage.getItem('linkedWallet');
      if (!raw) return;
      try {
        const { pubkey, providerName } = JSON.parse(raw);
        if (pubkey) setConnected(pubkey, providerName);
      } catch {}
    })();

    // --- Modal helpers ---
    const walletModal = byId('walletModal');
    const openModal = () => walletModal.showModal();
    const closeModal = () => walletModal.close();

    byId('closeModal').addEventListener('click', closeModal);

    // Trap focus/backdrop/Esc for nicer UX
    walletModal.addEventListener('cancel', (e)=>{ e.preventDefault(); closeModal(); });
    walletModal.addEventListener('click', (e)=>{ if (e.target === walletModal) closeModal(); });

    // Button wiring
    ['connectBtn','heroConnect','pricingConnect'].forEach(id=>{
      const el = byId(id); if(!el) return;
      el.addEventListener('click', () => {
        // If any provider is already injected, try that first; otherwise open options
        const injected = providers.phantom() || providers.solflare() || providers.backpack();
        if (injected) {
          const name = injected.isPhantom ? 'phantom'
                     : injected.isBackpack ? 'backpack'
                     : injected.isSolflare ? 'solflare'
                     : 'phantom';
          connectWith(name);
        } else {
          openModal();
        }
      });
    });

    // Modal buttons
    byId('connectPhantom').addEventListener('click', ()=> connectWith('phantom'));
    byId('connectSolflare').addEventListener('click', ()=> connectWith('solflare'));
    byId('connectBackpack').addEventListener('click', ()=> connectWith('backpack'));

    // Listen for account changes (legacy global if present)
    if (window?.solana) {
      window.solana.on?.('accountChanged', (pk) => {
        if (!pk) {
          sessionStorage.removeItem('linkedWallet');
          location.reload();
        } else {
          setConnected(pk.toString(), window.solana.isPhantom ? 'phantom' : 'wallet');
        }
      });
    }

    // Optional: gentle scroll for internal links (respect reduced motion)
    const prefersReduced = window.matchMedia?.('(prefers-reduced-motion: reduce)')?.matches;
    document.querySelectorAll('a[href^="#"]').forEach(a=>{
      a.addEventListener('click', e=>{
        const id = a.getAttribute('href').slice(1);
        const el = byId(id);
        if (el) { e.preventDefault(); el.scrollIntoView({ behavior: prefersReduced ? 'auto' : 'smooth', block:'start' }); }
      });
    });

    // --- Count-up animation for stats ---
    (function initCounters(){
      const counters = document.querySelectorAll('.count');
      if (!('IntersectionObserver' in window) || counters.length === 0) {
        counters.forEach(c => c.textContent = format(+c.dataset.target, c.dataset.format));
        return;
      }
      const seen = new WeakSet();
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(entry=>{
          if (entry.isIntersecting) {
            const el = entry.target;
            if (seen.has(el)) return;
            seen.add(el);
            animateCount(el, +el.dataset.target, el.dataset.format);
            io.unobserve(el);
          }
        });
      }, { threshold: 0.25 });

      counters.forEach(el => io.observe(el));

      function animateCount(el, target, fmt) {
        const dur = 1000 + Math.min(1500, target/50); // ms
        const start = performance.now();
        function frame(now){
          const p = Math.min(1, (now - start) / dur);
          const eased = 1 - Math.pow(1 - p, 3);
          const val = Math.round(eased * target);
          el.textContent = format(val, fmt);
          if (p < 1 && !document.hidden) requestAnimationFrame(frame);
        }
        requestAnimationFrame(frame);
      }
      function format(n, fmt) {
        if (fmt === 'usd') {
          return n.toLocaleString(undefined, { maximumFractionDigits: 0 });
        }
        return n.toLocaleString();
      }
    })();
  </script>
  <script>
    // --- Footer link placeholders ---
    const LINKS = {
      docs:    'https://docs.maestrobots.com/copytrade', // e.g. 'https://your-domain.tld/docs'
      twitter: 'https://x.com/SolTradingBot', // e.g. 'https://twitter.com/your_handle'
      terms:   '/terms.html', // e.g. '/terms.html'
      privacy: '/privacy.html'  // e.g. '/privacy.html'
    };
  
    [
      ['linkDocs','docs', true],
      ['linkTwitter','twitter', true],
      ['linkTerms','terms', false],
      ['linkPrivacy','privacy', false],
    ].forEach(([id,key,external])=>{
      const el = document.getElementById(id);
      const url = LINKS[key];
  
      if (url) {
        el.href = url;
        if (external) { el.target = '_blank'; el.rel = 'noopener'; }
      } else {
        // Prevent navigation until you set a URL
        el.addEventListener('click', (e)=>{
          e.preventDefault();
          alert(`TODO: set LINKS.${key} to the real URL for “${el.textContent}”.`);
        });
      }
    });
  </script>  
</body>
</html>
